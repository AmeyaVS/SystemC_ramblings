## This folder constains the sample of a full adder with a traces and testbench.

* Files:
	- `half_adder.h/cpp`: SystemC module implementation of half_adder.
	- `full_adder.h/cpp`: SystemC module implementation of full_adder.
	- `driver.h/cpp`: SystemC module for generating the test vector for Full Adder.
	- `monitor.h/cpp`: SystemC module for monitoring the test vectors for DUT Full Adder.
	- `full_adder_main.cpp`: SystemC module which connects the Full Adder module with driver and monitor module,
		and also contains the sc_main needed to run the simulation by the SystemC libraries.
	- `CMakeLists.txt`: CMake Support to build this example.
____

**Note:**
* Use the vcd_hier_manip tool which can be cloned from
[here](https://github.com/yTakatsukasa/vcd_hierarchy_manipulator.git)

* After cloning do these steps to build and update the `PATH` environment variable for the executable.
    ```sh
    make
    export PATH=$PATH:$PWD
    ```

* Use this tool as:
    ```sh
    vcd_hier_manip <input_vcd_file.vcd>
    ```
	where <input_vcd_file.vcd> is the input vcd trace generated by full_adder testbench.

**Note:** This tool will change the input vcd trace file if you want to keep original, kindly run the tool as follows:

```sh
vcd_hier_manip <input.vcd> --output <output.vcd>
```

 where:
 - <input.vcd> input vcd trace file name
 - <output.vcd> output vcd trace file name.

* Use gtkwave to view the waveform generated.
    ```sh
    gktwave <input.vcd>
    ```

____

## Project Directory Structure:

Following line's depict the usual approach to creating C/C++
projects/modules/libraries.

```text
02_adder          //< Project Top level directory
|- CMakeLists.txt //< CMakeLists.txt for building the project using CMake.
|- src/           //< Source Files for the Project [only *.cpp files] (Optional for header only libraries).
|- include/       //< Header Files for the Project [only *.h/hpp file]
|- include_pvt/   //< Private Header files(Optional)
|- docs/          //< Contains Project Documentation files or Doxygen input file.
|- cmake/         //< Contains Project specific configuration file used by CMake.
|- tests/         //< Contains UnitTests for the projects.
|- examples/      //< Contains Sample application or usage scenarios.(Optional).
|- CPackConfig.cmake //< Configuration file for CPack parameters.
|- build.cmake    //< Configuration script used by CTest for CI Tools.
|- CTestConfig.cmake //< Required by CTest when using build.cmake script.
|- jenkinsCoverage.sh //< Bash Shell Script to extract Coverage Information for Jenkins.
```

**Notes:** Following Notes will provide further details about each of the
resources in this project directory.

1. `src`: directory for header only libraries is optional.
2. `include_pvt`: directory for private header files.
3. `examples/tests`: directories for unit tests or sample examples for the
   project.
4. [CPackConfig.cmake](CPackConfig.cmake): This file is **not** supposed to be
   checked-into the source repository, required for configuring the build with
   `CPack` generated packages for installation.
5. [build.cmake](build.cmake): This is a CMake script used to define
   configuration used by CTest to build and execute the tests with the Code Coverage
   compilation flags. (This file is **supposed** to be used on Continuous
   Integration (e.g.: Jenkins) services only)
6. [CTestConfig.cmake](CTestConfig.cmake): This CMake script is utilized by the
   `CTest` to configure the project when using the command-line invocation:

   ```sh
   ctest -S build.cmake
   ```
   **Note:** Refer 4 above for more details.
7. [jenkinsCoverage.sh](jenkinsCoverage.sh): This script is supposed to be used
   on the CI server (Jenkins server), to generate the HTML Code Coverage Report.

## Building, Testing, Packaging, Installing and Code Coverage Reports

1. To build (pseudo build) create a directory for out-of-source tree build.

    ```sh
    mkdir build
    cd build
    ```
2. Configure the project and build.

   ```sh
   # Configure the Build to use Debugging Flags.
   # Following Build Types are supported:
   #  - Debug: No optimization + Debug Symbols.
   #  - Release: Full Compiler Optimizations enabled, no debug symbols.
   #  - RelWithDebInfo: Compiler Optimization Enabled with Debugging Symbols.

   # CMAKE_INSTALL_PREFIX specifies the installation path for the project:
   # e.g.:
   #     $HOME/apps/fulladder
   # Where the $HOME is the users `home` directory.

   # BUILD_DOC option specifies whether to build source code documentation or not.
   # BUILD_PACKAGE option specifies whether to build CPack based packages.
   cmake -DCMAKE_BUILD_TYPE=Debug \
         -DCMAKE_INSTALL_PREFIX=$HOME/apps/fulladder \
         -DBUILD_DOC=ON \
         -DBUILD_PACKAGE=ON \
         ..

   # For header only library nothing would be built.
   # Except the unittest using the library.
   # Will also build the documentation if enabled in the project configuration.
   make
   ```
   **Notes:**

    * Requires Doxygen and Graphviz Packages to be installed and available
    on the path environment variable to build the documentation of the project.


3. Execute the unit tests:

    ```sh
    # Execute the tests registered with the add_test() function of the CMake scripts.
    ctest
    ```

4. Generating the installer packages

   For creating installable Zip packages execute in the build directory:

   ```sh
   cpack
   ```

   **Note:**

   * Need to configure the project with `BUILD_PACKAGE` option during `CMake`
     configuration (see [2] above).
   * For Windows only `zip` packages are currently supported.
   * For GNU/Linux `zip` and debian based `deb` packages are supported.

5. Installing the project

   From the build directory of the project execute:

   ```sh
   make install
   ```
   **Note:**

   * For Windows using `Visual Studio` solutions is still in development.
   * When installing the project it also installs the tests directory under:
      ```
      share/doc/fulladder/examples
      ```
   * If building the tests under the installation location set the following
     environment variable: `FULLADDER_HOME`.
        ```sh
        # For bash environment variable settings.
        export FULLADDER_HOME=$HOME/apps/fulladder
        ```
     Then follow the configuration of the `CMake` project as explained
     previously.

6. Generating the Coverage Report

   Execute the [jenkinsCoverage.sh](jenkinsCoverage.sh) for generating the `LCOV`
   based HTML code coverage generation.

   ```sh
   # Usage ./jenkinsCoverage.sh <projectName>
   ./jenkinsCoverage.sh fulladder
   ```
   **Execute the script from the root of the project directory.**

   **Notes**:

   * This script is in development so usage might change overtime (**refer script
     itself for documentation**).
   * Requires `lcov` and `gcov` tools to be installed on the system for collecting
   the code coverage report.
   * The HTML reports are currently available under the directory:

      ```
      buildCoverage/<PROJECT_NAME>HTML
      ```

